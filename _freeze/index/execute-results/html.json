{
  "hash": "a8d7b5de4a3ec3100359753137a21415",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Economic Complexity of Australian Regions\nauthor:\n  - name: Hamish Gamble\n    orcid: 0000-0003-1277-1227\n    corresponding: true\n    email: hamish.gamble@flinders.edu.au\n    affiliations:\n      - Flinders University\n  - name: Sharif Rasel\n    orcid: \n    corresponding: false\n    roles: []\n    affiliations:\n      - Flinders University\nkeywords:\n  - Economic Complexity\n  - Advanced Manufacturing\nabstract: |\nplain-language-summary: |\nkey-points:\ndate: last-modified\nbibliography: references.bib\ncitation:\n  container-title: |\nnumber-sections: true\n---\n\n\n\n\n\n## Introduction\n\n## Literature Review\n\n@hidalgo2009 introduced the concept of economic complexity as a means of quantifying and explaining differences in the economic development trajectory of different countries. Their method used bilateral trade data to identify the network structure of countries and the products they export and built on the concept of relatedness introduced in @hidalgo2007. Economic complexity has been shown to be a positive predictor of Gross Domestic Product (GDP), and GDP growth. Increasing economic complexity has also been shown to decrease unemployment and increase employment @adam2023, reduce green house gas emissions @romero2021 and reduce income inequality @hartmann2017.\n\nRelatedness has since been applied across industry [@neffke2012], research areas [@guevara2016], occupation [@muneepeerakul2013] and technology (patents) [@kogler2013].\n\nThe relatedness approach has also been used to quantify economic complexity across cities, states, and regions, using employment data[@ecus, @ecnz, @ecmexico], business counts[@ecchina], patent classifications [@balland2021], and interstate and international trade data [@ecaus].\n\nDespite differences in data sources, the method for calculating economic complexity in the literature is relatively standard. The presence of an activity in a region is often identified using a location quotient method, such that an activity is said to be present in a region if:\n\n$$\\frac{X_a^r/\\sum_{a}X_a^r}{\\sum_{r}X_a^r/\\sum_{r,a}X_a^r} \\geq 1$$\n\nWhere $X$ is the measure of an activity $a$ in region $r$ - such as the level of employment in an occupation in a city, or the number of businesses classified in an industry in a province, or the value of exports of a product from a country. The location quotient method creates a binary matrix $M$ with $a$ rows and $r$ columns.\n\n### Regional economic complexity of small areas\n\nThe location quotient method can be unreliable due to the discontinuity at 1. This is especially relevant when economic complexity is calculated in regional areas where either $X_a^r$ or $\\frac{\\sum_{r}X_a^r}{\\sum_{r,a}X_a^r}$ are small. In these cases, small changes, or measurement error in $X_a^r$ can significantly change the location quotient.\n\nThe choice of region size and activity classification is important. In a study of the economic complexity of US regions, @ecus use metropolitan areas as the basis for calculations. Metropolitan areas in the United States are defined such that jobs within a given area are held by residents who live in that area.Metropolitan areas have a population of at least 50,000 people. The smallest MSA was estimated to have a 2023 population of 57,700 (about 0.015% of US population). They find a poor correlation between ECI calculated at higher level aggregated industry classifications indicating the importance of a high degree of disaggregation to provide as much information to the model as possible @ecus.\n\nIn New Zealand, @ecnz use weighted correlations of local employment shares. Regions range from a population of 1,434 to 573,150 with a mean population of 29,947 and median population of 6,952. Employment is measured as an industry-occupation pair.\n\n-   Differences in relationship between complexity and relatedness on indicators may be entirely context dependent.\n\n## Data & Methods {#sec-data-methods}\n\n### Data\n\n-   Calculate economic complexity indicators for Australian regions using employment data from the 2021 Census.\n\n-   Regions classified by Statistical Areas Level 3 (SA3)\n\n-   Economic activity classified by ANZSIC industry division and ANZSCO major group\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'tidyverse' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'tibble' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'tidyr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'readr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'purrr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'dplyr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'stringr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'forcats' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'lubridate' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(strayr)\nlibrary(ecomplexity)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'sf' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLinking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.3.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(tmap)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'tmap'\n\nThe following object is masked from 'package:datasets':\n\n    rivers\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(spdep)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'spdep' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: spData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'spData' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(spatialreg)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'spatialreg' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\n\nAttaching package: 'spatialreg'\n\nThe following objects are masked from 'package:spdep':\n\n    get.ClusterOption, get.coresOption, get.mcOption,\n    get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,\n    set.coresOption, set.mcOption, set.VerboseOption,\n    set.ZeroPolicyOption\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(huxtable)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'huxtable' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'huxtable'\n\nThe following object is masked from 'package:dplyr':\n\n    add_rownames\n\nThe following object is masked from 'package:ggplot2':\n\n    theme_grey\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(flextable)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'flextable' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'flextable'\n\nThe following objects are masked from 'package:huxtable':\n\n    align, as_flextable, bold, font, height, italic, set_caption,\n    valign, width\n\nThe following object is masked from 'package:purrr':\n\n    compose\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nindustry_occupation_sa3 <- read_complexitydata(\"sa3_indp1_occp1\", export_dir = \"data\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nReading sa3_indp1_occp1 file found in data\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nregions <- industry_occupation_sa3 |> \n  group_by(x = str_detect(sa3, \"POW|Migratory\")) |>  \n  summarise(count = sum(count)) |> \n  mutate(p = count/sum(count),\n         x = ifelse(!x, \"included\", \"excluded\")) |> \n  split(f = ~x)\n\nsa3 <- read_absmap(\"sa32021\", export_dir = \"data\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nReading sa32021 file found in data\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nindustry_occupation_sa3 <- industry_occupation_sa3 |> \n  filter(!str_detect(sa3, \"POW|Migratory\")) |> \n  mutate(anzsic_division = fct_inorder(anzsic_division),\n         anzsco_major = fct_inorder(anzsco_major), \n         industry_occupation = paste0(anzsic_division, \" (\", anzsco_major,\")\"),\n         industry_occupation = fct_inorder(industry_occupation)) |> \n  group_by(sa3, industry_occupation) |> \n  summarise(count = sum(count),\n            .groups = \"drop\") \n```\n:::\n\n\n\n\n\n-   We exclude individuals who identify their place of work as a Migratory - Offshore - Shipping region or as No Fixed Address. Employment in these regions totals 497,913 or about 4% of the total sample.\n\n-   Following @ecnz, employment is aggregated into industry-occupation pairs, allowing for differentiation between, for example, managers working in agriculture, forestry, and fishing, and managers working in retail trade.\n\n-   Dataset covers 340 regions and 152 industry-occupations. @fig-employment-density shows the presence of any level of employment within a region and industry-occupation. As can be seen, there is a high level of employment density across our data, with 88.5% of all combinations of region, industry, and occupation.\n\n\n\n\n\n::: {#cell-fig-employment-density .cell}\n\n```{.r .cell-code .hidden}\nemployment_density <- function(data, region, activity, flip = FALSE) {\n  region_size = paste0(region, \"_size\")\n  activity_size = paste0(activity, \"_size\")\n  \n  data |> \n    group_by(.data[[region]])  |> \n    mutate({{region_size}} := sum(count)) |> \n    group_by(.data[[activity]]) |> \n    mutate({{activity_size}} := sum(count)) |> \n    ungroup() |> \n    mutate(presence = count > 0,\n           {{region}} := fct_infreq(.data[[region]], w = .data[[region_size]]),\n           {{activity}} := fct_infreq(.data[[activity]], w = .data[[activity_size]])) |> \n    ggplot(aes(x = if(!flip) .data[[region]] else .data[[activity]],\n               y = if(!flip) .data[[activity]] else .data[[region]],\n               fill = presence)) + \n    geom_raster() + \n    scale_fill_manual(breaks = c(TRUE, FALSE),\n                      values = c(\"#3182db\", \"white\")) + \n  theme(axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.border = element_rect(fill = NA),\n        legend.position = \"none\") + \n  coord_equal()\n}\n\nemployment_density(industry_occupation_sa3, \"sa3\", \"industry_occupation\") + \n  labs(x = \"Region\",\n       y = \"Industry-Occupation\")\n```\n\n::: {.cell-output-display}\n![Presence of employment across regions and industry-occupations.](index_files/figure-html/fig-employment-density-1.png){#fig-employment-density width=576}\n:::\n:::\n\n\n\n\n\n### Method\n\nThis section follows the method of @ecnz using correlations of employment shares rather than a location quotient method.\n\n#### Relatedness\n\nActivities are related based on the weighted correlation between the local activity share of employment, weighted by each regions share of total employment.\n\n-   First calculate the weighted covariance\n\n$$\ncov_{aa} = \\sum_{c \\in C} (\\frac{E_c^{a_i}}{E_c}-\\frac{E^{a_i}}{E})(\\frac{E_c^{a_j}}{E_c}-\\frac{E^{a_j}}{E})\n$$\n\n-   Divide the weighted covariance by the city share-weighted standard deviations of the local activity shares to get the weighted correlation.\n\n-   Map the correlation to the interval $[0,1]$ such that:\n\n    $$\n    r_{aa} = \\frac{1}{2}(cor(a_i, a_j) + 1)\n    $$\n\nCity relatedness is calculated symmetrically such that:\n\n$$\nr_{cc} = \\frac{1}{2}(cor(c_i, c_j) + 1)\n$$\n\n#### Complexity\n\nActivity complexity is defined by the second eigenvector of the matrix $r_{aa}$ and city complexity is defined by the second eigenvector of the matrix $r_{cc}$. The sign of activity complexity is set such that it is positively correlated with the weighted mean size of cities that contain activity $a$, and the sign of city complexity is set such that it is positively correlated with the local share-weighted mean complexity of activities in city $c$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# function to calculate complexity from a region * activity matrix m\n\ncomplexity_nz <- function(m, base_data) {\n  \n  activity_share <- m / rowSums(m)\n  national_share_employment <- rowSums(m) / sum(m)\n  \n  region_name <- colnames(base_data)[1]\n  activity_name <- colnames(base_data)[2]\n  \n  # Relatedness of activities is the weighted covariance between the local share vectors for activities i and j, \n  # weighted by each regions share of total employment.\n  \n  \n  r_aa <- 0.5*(cov.wt(x = activity_share, wt = national_share_employment, cor = TRUE)$cor + 1)\n  \n  \n  #Complexity of activity a is the element a of the standardized second eigenvector of the row-standardized relatedness matrix r.\n  complexity <- list()\n  complexity$activity <- Re(eigen(r_aa/rowSums(r_aa))$vector[,2])\n  complexity$activity  <- (complexity$activity  - mean(complexity$activity ))/sd(complexity$activity)\n  names(complexity$activity) <- colnames(m)\n  \n  #Complexity is positively correlated with the weighted mean size of cities that contain activity a\n  wmsc <- colSums(m/colSums(m)*rowSums(m))\n  \n  if (cor(complexity$activity , wmsc) < 0) {\n    complexity$activity  = -1*complexity$activity\n  } else complexity$activity  = complexity$activity \n  \n  message(glue::glue(\"most complex activity: {names(complexity$activity[complexity$activity == max(complexity$activity)])}\")) \n  \n  \n  # Relatedness of cities is symmetric to activities.\n  city_share <- t(m / rowSums(m))\n  national_share_activity <- colSums(m)/sum(m)\n  r_cc <- 0.5*(cov.wt(x = city_share, wt = national_share_activity, cor = TRUE)$cor + 1)\n  \n  complexity$city <- Re(eigen(r_cc/rowSums(r_cc))$vector[,2])\n  complexity$city <- (complexity$city- mean(complexity$city))/sd(complexity$city)\n  names(complexity$city) <- rownames(m)\n  \n  #City complexity is positively correlated with the local share weighted mean complexity of activities in city c.\n  wmc <- rowSums(m/colSums(m)*complexity$activity)\n  \n  if (cor(complexity$city, wmc) < 0 || complexity$city[\"Brisbane Inner\"] < 0) {\n    complexity$city = -1 * complexity$city\n    } else complexity$city = complexity$city\n  \n  message(glue::glue(\"most complex city: {names(complexity$city[complexity$city == max(complexity$city)])}\")) \n  \n  df.complexity <- inner_join(base_data, enframe(complexity$city, name = region_name, value = \"city_complexity\")) |> \n    inner_join(enframe(complexity$activity, name = activity_name, value = \"activity_complexity\"))\n  return(df.complexity)\n}\n```\n:::\n\n\n\n\n\n## Results\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#|\nm <- industry_occupation_sa3 |> \n  pivot_wider(id_cols = sa3,\n              names_from = industry_occupation,\n              values_from = count) |> \n  column_to_rownames(var = \"sa3\") |> \n  as.matrix()\n\ncomplexity <- list()\n\ncomplexity$indp_occp <- complexity_nz(m, base_data = industry_occupation_sa3)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex activity: Professional, Scientific and Technical Services (Professionals)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex city: Brisbane Inner\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sa3)`\nJoining with `by = join_by(industry_occupation)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncomplexity$indp_occp_rca <- calculate_complexity(industry_occupation_sa3, \n                                                 region = \"sa3\",\n                                                 product = \"industry_occupation\",\n                                                 value = \"count\", \n                                                 year = 2021) |> \n  select(sa3, industry_occupation, count, city_complexity = country_complexity_index, activity_complexity = product_complexity_index)\n```\n:::\n\n\n\n\n\n@fig-gcc-complexity shows the regional complexity of SA3 regions in Australian Greater Capital City Areas based on 2021 Census data. Complexity is highest in capital cities and surrounding regions.\n\n\n\n\n\n::: {#cell-fig-gcc-complexity .cell}\n\n```{.r .cell-code .hidden}\ncomplexity_map <- function(data, layer) {\n  data <- data |> \n    pluck(layer) |> \n    distinct(sa3, city_complexity) |> \n    left_join(sa3, by = c(\"sa3\" = \"sa3_name_2021\")) |> \n  st_as_sf() \n  \n  data |> \n  filter(str_detect(gcc_name_2021, \"Australian Capital Territory|Greater\")) |> \n  tm_shape() +\n  tm_polygons(fill = \"city_complexity\",\n              fill.scale = tm_scale_continuous(values = \"greek\", ),\n              fill.legend = tm_legend(title = \"City Complexity Index\",\n                                      orientation = \"landscape\")) +\n  tm_facets(\"gcc_name_2021\") +\n  tm_place_legends_bottom()\n  \n  }\n\n\ncomplexity_map(complexity, \"indp_occp\")\n```\n\n::: {.cell-output-display}\n![Complexity of Australian Greater Capital City Areas](index_files/figure-html/fig-gcc-complexity-1.png){#fig-gcc-complexity width=576}\n:::\n:::\n\n\n\n\n\n### Regression\n\n$ECI_r = CC + log(employment) + log(population) + log(income_{hh}) + log(business_{entries}) + business_{share}$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nload(\"data/data_by_region.rda\")\n\n\ncomplexity.reg <- complexity$indp_occp |> \n  distinct(sa3, city_complexity) |> \n  inner_join(data_by_region, by = c(\"sa3\" = \"region\")) |> \n  inner_join(sa3, by = c(\"sa3\" = \"sa3_name_2021\")) |> \n  group_by(state_name_2021) |> \n  mutate(business_share = total_businesses_no/sum(total_businesses_no, na.rm = TRUE)) |>\n  ungroup() |> \n  mutate(turnover_greater_2m = total_businesses_no - (businesses_with_turnover_of_10m_or_more_no + businesses_with_turnover_of_5m_to_less_than_10m_no + businesses_with_turnover_of_2m_to_less_than_5m_no),\n         turnover_greater_2m_share = turnover_greater_2m/total_businesses_no,\n         across(c(total_businesses_no, \n                  total_business_entries_no,\n                  total_business_exits_no,\n                  total_persons_employed_aged_15_years_and_over_no,\n                  estimated_resident_population_persons_no,\n                  median_equivalised_total_household_income_weekly), \n                .fn = ~log(.x),\n                .names = \"log_{.col}\")) |> \n  drop_na(city_complexity,\n          log_total_businesses_no,\n          log_total_business_entries_no,\n          log_total_business_exits_no,\n          turnover_greater_2m_share,\n          log_estimated_resident_population_persons_no,\n          business_share,\n          log_median_equivalised_total_household_income_weekly) |> \n  st_as_sf() \n\nregression_spec <- parse(text = \"city_complexity ~ log_total_businesses_no + log_total_business_entries_no + log_total_business_exits_no + turnover_greater_2m_share + log_total_persons_employed_aged_15_years_and_over_no + log_estimated_resident_population_persons_no + business_share + log_median_equivalised_total_household_income_weekly\")[[1]]\n\nfit.ols <- lm(regression_spec,\n              data = complexity.reg)\n```\n:::\n\n\n\n\n\n### Spatial Correlation\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nnb <- poly2nb(complexity.reg, queen = TRUE)\nlw <- nb2listw(nb, style = \"W\", zero.policy = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nmoranI <- moran(complexity.reg$city_complexity, listw = lw, n = length(nb), S0 = Szero(lw))\n\nmoranIp <- moran.mc(complexity.reg$city_complexity, lw, nsim = 1000)\n```\n:::\n\n\n\n\n\nBased on @fig-gcc-complexity, it looks like there are clusters of complexity, centred around capital cities.\n\n\n\n\n\n::: {#cell-fig-residuals-map .cell}\n\n```{.r .cell-code .hidden}\ncomplexity.reg <- complexity.reg |>\n  mutate(olsresid = resid(fit.ols)) \n\ntm_shape(complexity.reg) + \n  tm_polygons(fill = \"olsresid\",\n              fill.scale = tm_scale_continuous(values = \"reds\"),\n              fill.legend = tm_legend(outside = TRUE,\n                                      title = \"OLS Residuals\",\n                                      text.size = 0.8),\n              col = \"grey80\",\n              lwd = 0.5) +\n  tm_layout(frame = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n[plot mode] fit legend/component: Some legend items or map compoments do not fit well, and are therefore rescaled. Set the tmap option 'component.autoscale' to FALSE to disable rescaling.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Residuals from linear regression](index_files/figure-html/fig-residuals-map-1.png){#fig-residuals-map width=576}\n:::\n:::\n\n\n\n\n\nThe residuals from the linear regression are shown in @fig-residuals-map which also shows that the distribution of the residuals appears non-random.\n\n\n\n\n\n::: {#cell-fig-moran-plot .cell}\n\n```{.r .cell-code .hidden}\nmoran.plot(as.numeric(scale(complexity.reg$city_complexity)),\n           listw = lw,\n           xlab = \"City Complexity\",\n           ylab = \"Neighbours City Complexity\")\n```\n\n::: {.cell-output-display}\n![Moran Scatterplot for City Complexity in Australia](index_files/figure-html/fig-moran-plot-1.png){#fig-moran-plot width=576}\n:::\n:::\n\n\n\n\n\nThe correlation between complexity and lagged complexity is shown in @fig-moran-plot which also shows a dependency. Finally, we observe a global Moran's I of 0.498499 with a p.value of 0. As such, the data appear to be spatially autocorrelated, so a lagged AR or lagged error model should be estimated instead.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nfit.lag <- lagsarlm(regression_spec,\n                    data = complexity.reg,\n                    listw = lw, \n                    zero.policy = TRUE)\n\nfit.err <- errorsarlm(regression_spec,\n                      data = complexity.reg,\n                      listw = lw, \n                      zero.policy = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nhuxreg(\"OLS\" = fit.ols, \"Spatial AR\" = fit.lag, \"Spatial Error\" = fit.err)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<table class=\"huxtable\" data-quarto-disable-processing=\"true\" style=\"border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  \" id=\"tab:regression-results\">\n<col><col><col><col><tr>\n<th style=\"vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><th style=\"vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">OLS</th><th style=\"vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">Spatial AR</th><th style=\"vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">Spatial Error</th></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(Intercept)</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-17.224 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-13.830 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-16.581 ***</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(3.417)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(3.351)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(3.561)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">log_total_businesses_no</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-0.102&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.063&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-0.114&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.230)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.221)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.254)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">log_total_business_entries_no</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.028&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-0.060&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-0.037&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.409)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.389)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.395)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">log_total_business_exits_no</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.937 *&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.650&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.939 *&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.431)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.416)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.420)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">turnover_greater_2m_share</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.491&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-0.083&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-0.220&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(1.748)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(1.668)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(1.721)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">log_total_persons_employed_aged_15_years_and_over_no</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-1.691 **&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-1.382 **&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-1.793 **&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.517)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.500)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.565)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">log_estimated_resident_population_persons_no</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">1.208 *&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">1.096 *&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">1.430 *&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.511)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.490)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.565)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">business_share</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">4.280 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">4.457 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">4.371 **&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(1.206)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(1.149)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(1.415)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">log_median_equivalised_total_household_income_weekly</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">2.213 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">1.669 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">2.097 ***</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.283)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.294)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.321)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">rho</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.273 ***</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.060)&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">lambda</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.360 ***</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.066)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">N</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">330&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">330&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">330&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">R2</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.528&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.560&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.574&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">logLik</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-346.835&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-338.084&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-335.202&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">AIC</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">713.669&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">698.168&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">692.403&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th colspan=\"4\" style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>\n</table>\n\n```\n\n:::\n:::\n\n\n\n\n\n## Hot spots\n\n\n\n\n\n::: {#cell-fig-complexity-hot-spots .cell}\n\n```{.r .cell-code .hidden}\nMC.i <- localmoran_perm(complexity.reg$city_complexity, lw, nsim = 9999) \n\nMC.i.df <- MC.i |> \n  as.data.frame() \n\ncomplexity.reg$p <- MC.i.df$`Pr(folded) Sim`\ncomplexity.reg$Ii <- hotspot(MC.i, \n                              Prname = \"Pr(folded) Sim\", \n                              cutoff = 0.05, \n                              p.adjust = \"fdr\")\ncomplexity.reg$Ii <- factor(complexity.reg$Ii, \n                             levels = c(\"High-High\",\n                                        \"Low-Low\",\n                                        \"Low-High\", \n                                        \"High-Low\",\n                                        \">0.05\"))\ncomplexity.reg$Ii[is.na(complexity.reg$Ii)] <- \">0.05\"\n\npal2 <- c( \"#FF0000\", \"#0000FF\", \"#a7adf9\", \"#f4ada8\",\"#ededed\")\n\ntm_shape(complexity.reg) + \n  tm_polygons(fill = \"Ii\",\n              fill.scale = tm_scale_categorical(values = pal2),\n              fill.legend = tm_legend(outside = TRUE, \n                                      text.size = 0.8),\n              col = \"grey80\",\n              lwd = 0.5) +\n  tm_layout(frame = FALSE) + \n  tm_facets(by = \"gcc_name_2021\")\n```\n\n::: {.cell-output-display}\n![City Complexity hot spots (based on local Moran's I p.values)](index_files/figure-html/fig-complexity-hot-spots-1.png){#fig-complexity-hot-spots width=576}\n:::\n:::\n\n\n\n\n\n## Conclusion\n\n## Appendix\n\nRegional economic complexity can be calculated using other data, including employment by industry and employment by occupation.\n\n### Other Employment Indicators\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nindustry_sa3 <- read_complexitydata(\"sa3_indp4\", export_dir = \"data\") |> \n  mutate(year = 2021) |> \n  filter(!str_detect(indp, \"[A-S]|&&&&|@@@@\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nReading sa3_indp4 file found in data\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\noccupation_sa3 <- read_complexitydata(\"sa3_occp4\", export_dir = \"data\") |> mutate(year = 2021)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nReading sa3_occp4 file found in data\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncomplexity$indp4 <- calculate_complexity(industry_sa3, region = \"sa3\", product = \"indp\", value = \"count\", year = 2021)  |> mutate(product = \"indp4\")\ncomplexity$occp4 <- calculate_complexity(occupation_sa3, region = \"sa3\", product = \"occp\", value = \"count\", year = 2021) |> mutate(product = \"occp4\")\n```\n:::\n\n\n\n\n\nEmployment density is much sparser when using 4-digit industry of employment data. Only 48 of the industry class-region combinations contain any level of employment.\n\n\n\n\n\n::: {#cell-fig-employment-density-classifications .cell}\n\n```{.r .cell-code .hidden}\nlibrary(patchwork)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'patchwork' was built under R version 4.4.1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\np1 <- employment_density(industry_sa3, \"sa3\", \"indp\") +\n  labs(x = \"Region\",\n       y = \"Industry Class\") \np2 <- employment_density(occupation_sa3, \"sa3\", \"occp\") +\n  labs(x = \"Region\",\n       y = \"Occupation Unit\")\n\nwrap_plots(p1, p2) + \n  plot_annotation(tag_levels = \"A\")\n```\n\n::: {.cell-output-display}\n![Employment density, SA3 regions: (A) ANZSIC industry class, (B) ANZSCO occupation unit](index_files/figure-html/fig-employment-density-classifications-1.png){#fig-employment-density-classifications width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#|label: city-complexity-industry\n\nindustry_sa3 <- industry_sa3 |> \n  group_by(indp) |> \n  mutate(indp_size = sum(count)) |> \n  filter(indp_size > 0) |> \n  ungroup()\n\nm <- industry_sa3 |> \n  pivot_wider(id_cols = sa3,\n              names_from = indp,\n              values_from = count) |> \n  column_to_rownames(var = \"sa3\") |> \n  as.matrix()\n\ncomplexity$indp4 <- complexity_nz(m, industry_sa3)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex activity: 6931\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex city: Cottesloe - Claremont\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sa3)`\nJoining with `by = join_by(indp)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nm <- occupation_sa3 |> \n  pivot_wider(id_cols = sa3,\n              names_from = occp,\n              values_from = count) |> \n  column_to_rownames(var = \"sa3\") |> \n  as.matrix()\n\ncomplexity$occp4 <- complexity_nz(m, occupation_sa3)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex activity: Human Resource Managers\nmost complex city: North Sydney - Mosman\nJoining with `by = join_by(sa3)`Joining with `by = join_by(occp)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nfull_join(distinct(complexity$indp4, sa3, city_complexity),\n          distinct(complexity$indp_occp, sa3, city_complexity), by = \"sa3\") |>\n  ggplot(aes(x = city_complexity.x, y = city_complexity.y)) + \n  geom_point() + labs(x = \"City Complexity (Industry Division)\", y = \"Economic Complexity (Industry-Occupation)\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncomplexity.reg.all <- complexity.reg |> \n  inner_join(distinct(complexity$indp4, sa3, indp_complexity = city_complexity), by = \"sa3\") |> \n  inner_join(distinct(complexity$occp4, sa3, occp_complexity = city_complexity))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sa3)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nreg_spec <- parse(text = \"indp_complexity ~ log_total_businesses_no + log_total_business_entries_no + log_total_business_exits_no + turnover_greater_2m_share + log_total_persons_employed_aged_15_years_and_over_no + log_estimated_resident_population_persons_no + business_share + log_median_equivalised_total_household_income_weekly\")[[1]]\n\nfit.ols <- lm(reg_spec, data = complexity.reg.all)\n```\n:::\n\n\n\n\n\n### Specific Industries\n\nFollowing @mealy2022 analysis of green economic complexity, we can apply an advanced manufacturing lens to determine advanced manufacturing complexities.\n\n\n\n\n\n::: {#tbl-advanced-manufacturing .cell}\n\n```{.r .cell-code .hidden}\nam <-  tibble::tribble(\n   ~indp,                                                           ~description,\n                    1811L,                                         \"Industrial gas manufacturing\",\n                    1812L,                                 \"Basic organic chemical manufacturing\",\n                    1813L,                               \"Basic inorganic chemical manufacturing\",\n                    1821L,                   \"Synthetic resin and synthetic rubber manufacturing\",\n                    1829L,                                    \"Other basic polymer manufacturing\",\n                    1831L,                                             \"Fertiliser manufacturing\",\n                    1832L,                                              \"Pesticide manufacturing\",\n                    1841L,             \"Human pharmaceutical and medicinal product manufacturing\",\n                    1842L,        \"Veterinary pharmaceutical and medicinal product manufacturing\",\n                    1851L,                                      \"Cleaning compound manufacturing\",\n                    1852L,                      \"Cosmetic and toiletry preparation manufacturing\",\n                    1891L,                          \"Photographic chemical product manufacturing\",\n                    1892L,                                              \"Explosive manufacturing\",\n                    1899L,                    \"Other basic chemical product manufacturing n.e.c.\",\n                    2311L,                                          \"Motor vehicle manufacturing\",\n                    2312L,                         \"Motor vehicle body and trailer manufacturing\",\n                    2313L,                        \"Automotive electrical component manufacturing\",\n                    2319L,                              \"Other motor vehicle parts manufacturing\",\n                    2391L,                                     \"Shipbuilding and repair services\",\n                    2392L,                                     \"Boatbuilding and repair services\",\n                    2393L,              \"Railway rolling stock manufacturing and repair services\",\n                    2394L,                           \"Aircraft manufacturing and repair services\",\n                    2399L,                       \"Other transport equipment manufacturing n.e.c.\",\n                    2411L,         \"Photographic, optical and ophthalmic equipment manufacturing\",\n                    2412L,                         \"Medical and surgical equipment manufacturing\",\n                    2419L,            \"Other professional and scientific equipment manufacturing\",\n                    2421L,               \"Computer and electronic office equipment manufacturing\",\n                    2422L,                                \"Communication equipment manufacturing\",\n                    2429L,                             \"Other electronic equipment manufacturing\",\n                    2431L,                                \"Electric cable and wire manufacturing\",\n                    2432L,                            \"Electric lighting equipment manufacturing\",\n                    2439L,                             \"Other electrical equipment manufacturing\",\n                    2441L,                                    \"Whiteware appliance manufacturing\",\n                    2449L,                               \"Other domestic appliance manufacturing\",\n                    2451L,                                    \"Pump and compressor manufacturing\",\n                    2452L, \"Fixed space heating, cooling and ventilation equipment manufacturing\",\n                    2461L,                   \"Agricultural machinery and equipment manufacturing\",\n                    2462L,                      \"Mining and construction machinery manufacturing\",\n                    2463L,                           \"Machine tool parts and parts manufacturing\",\n                    2469L,              \"Other specialised machinery and equipment manufacturing\",\n                    2491L,                         \"Lifting and handling equipment manufacturing\",\n                    2499L,                          \"Other machinery and equipment manufacturing\"\n   ) |> \n  mutate(indp = as.character(indp)) \n\nflextable(am)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-eb7edcd6{}.cl-eb6f6850{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-eb755c92{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-eb758d34{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-eb758d48{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-eb758d49{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-eb7edcd6'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-eb758d34\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">indp</span></p></th><th class=\"cl-eb758d34\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">description</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1811</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Industrial gas manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1812</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Basic organic chemical manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1813</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Basic inorganic chemical manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1821</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Synthetic resin and synthetic rubber manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1829</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other basic polymer manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1831</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Fertiliser manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1832</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Pesticide manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1841</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Human pharmaceutical and medicinal product manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1842</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Veterinary pharmaceutical and medicinal product manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1851</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Cleaning compound manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1852</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Cosmetic and toiletry preparation manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1891</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Photographic chemical product manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1892</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Explosive manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">1899</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other basic chemical product manufacturing n.e.c.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2311</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Motor vehicle manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2312</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Motor vehicle body and trailer manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2313</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Automotive electrical component manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2319</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other motor vehicle parts manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2391</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Shipbuilding and repair services</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2392</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Boatbuilding and repair services</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2393</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Railway rolling stock manufacturing and repair services</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2394</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Aircraft manufacturing and repair services</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2399</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other transport equipment manufacturing n.e.c.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2411</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Photographic, optical and ophthalmic equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2412</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Medical and surgical equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2419</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other professional and scientific equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2421</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Computer and electronic office equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2422</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Communication equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2429</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other electronic equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2431</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Electric cable and wire manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2432</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Electric lighting equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2439</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other electrical equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2441</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Whiteware appliance manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2449</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other domestic appliance manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2451</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Pump and compressor manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2452</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Fixed space heating, cooling and ventilation equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2461</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Agricultural machinery and equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2462</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Mining and construction machinery manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2463</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Machine tool parts and parts manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2469</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other specialised machinery and equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2491</span></p></td><td class=\"cl-eb758d48\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Lifting and handling equipment manufacturing</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-eb758d49\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">2499</span></p></td><td class=\"cl-eb758d49\"><p class=\"cl-eb755c92\"><span class=\"cl-eb6f6850\">Other machinery and equipment manufacturing</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\namci <- calculate_complexity(industry_sa3, region = \"sa3\", product = \"indp\", value = \"count\", year = 2021) |> \n  mutate(m = as.numeric(rca >= 1),\n         is_am = as.numeric(indp %in% am$indp),\n         pci = scales::rescale(product_complexity_index, to = c(0, 1)),\n         p = m * is_am) |> \n  group_by(sa3) |> \n  summarise(amci = sum(pci * p),\n            amp = sum((1-p)*density*pci)/sum(1-p),\n            amce = sum(count*is_am)) |> \n  mutate(across(c(amci, amp), ~ (.x - mean(.x))/sd(.x))) \n\ncomplexity.reg <- complexity.reg |> \n  inner_join(amci)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sa3)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlm.amci <- lm(city_complexity ~ median_age_persons_years + estimated_resident_population_persons_no + total_business_entries_no + total_business_exits_no + business_share + amci + amp, data = complexity.reg)\n```\n:::\n\n\n\n\n\n### Smaller Areas\n\n\n\n\n\n::: {#cell-fig-employment-density-sa2 .cell}\n\n```{.r .cell-code .hidden}\nindustry_occupation_sa2 <- read_complexitydata(\"sa2_indp1_occp1\", export_dir = \"data\")|> \n  filter(!str_detect(sa2, \"POW|Migratory\")) |> \n  mutate(anzsic_division = fct_inorder(anzsic_division), \n         anzsco_major = fct_inorder(anzsco_major), \n         industry_occupation = paste0(anzsic_division, \" (\", anzsco_major, \")\"),\n         industry_occupation = fct_inorder(industry_occupation)) |> \n  group_by(sa2, industry_occupation) |> \n  summarise(count = sum(count), .groups = \"drop\") |> \n  group_by(sa2) |> \n  mutate(sa2_size = sum(count)) |> \n  group_by(industry_occupation) |> \n  mutate(industry_occupation_size = sum(count)) |> \n  ungroup() |> \n  filter(sa2_size > 0,\n         industry_occupation_size > 0)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nReading sa2_indp1_occp1 file found in data\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemployment_density(industry_occupation_sa2, \"sa2\", \"industry_occupation\", flip = TRUE) + \n  labs(x = \"Industry-Occupation\",\n       y = \"Region\") +\n  coord_equal(ratio = 0.25)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nCoordinate system already present. Adding new coordinate system, which will\nreplace the existing one.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Employment density, Industry-occupation, SA2 regions](index_files/figure-html/fig-employment-density-sa2-1.png){#fig-employment-density-sa2 width=576}\n:::\n:::\n\n::: {.cell execute='false'}\n\n```{.r .cell-code .hidden}\nm <- industry_occupation_sa2 |> \n  pivot_wider(id_cols = sa2, \n              names_from = industry_occupation,\n              values_from = count) |> \n  column_to_rownames(var = \"sa2\") |> \n  as.matrix()\n\ncomplexity_small <- complexity_nz(m, industry_occupation_sa2)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex activity: Professional, Scientific and Technical Services (Professionals)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmost complex city: Ashburton (Vic.)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sa2)`\nJoining with `by = join_by(industry_occupation)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncomplexity_small |> \n  distinct(sa2, city_complexity) |> \n  inner_join(read_absmap(\"sa22021\", export_dir = \"data\"), \n             by = c(\"sa2\" = \"sa2_name_2021\")) |> \n  st_as_sf() |> \n  filter(str_detect(gcc_name_2021, \"Australian Capital Territory|Greater\")) |>\n  tm_shape() +\n  tm_polygons(fill = \"city_complexity\",\n              col = \"grey90\",\n              lwd = 0.05,\n              fill.scale = tm_scale_continuous(values = 'greek'), \n              fill.legend = tm_legend(title = \"City Complexity Index\",\n                                      orientation = \"landscape\"))+ \n  tm_facets(\"gcc_name_2021\") + \n  tm_place_legends_bottom()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nReading sa22021 file found in data\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/sa2-indp-occp-complexity-1.png){width=576}\n:::\n:::\n\n\n\n\n\n## References {.unnumbered}\n\n::: {#refs}\n:::\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}